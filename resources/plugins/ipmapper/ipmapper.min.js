/*!
 * IP Address geocoding API for Google Maps
 * http://lab.abhinayrathore.com/ipmapper/
 * Last Updated: June 13, 2012
 */
var IPMapper={map:null,mapTypeId:google.maps.MapTypeId.ROADMAP,latlngbound:null,infowindow:null,baseUrl:"http://freegeoip.net/json/",initializeMap:function(b){IPMapper.latlngbound=new google.maps.LatLngBounds();var c=new google.maps.LatLng(0,0);var a={zoom:1,center:c,mapTypeId:IPMapper.mapTypeId};IPMapper.map=new google.maps.Map(document.getElementById(b),a);IPMapper.infowindow=new google.maps.InfoWindow();google.maps.event.addListener(IPMapper.infowindow,"closeclick",function(){IPMapper.map.fitBounds(IPMapper.latlngbound);IPMapper.map.panToBounds(IPMapper.latlngbound)})},addIPArray:function(b){b=IPMapper.uniqueArray(b);for(var a=0;a<b.length;a++){IPMapper.addIPMarker(b[a])}},addIPMarker:function(b){ipRegex=/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/;if($.trim(b)!=""&&ipRegex.test(b)){var a=encodeURI(IPMapper.baseUrl+b+"?callback=?");$.getJSON(a,function(e){if($.trim(e.latitude)!=""&&e.latitude!="0"&&!isNaN(e.latitude)){var h=e.latitude;var d=e.longitude;var f="";$.each(e,function(i,j){f+="<b>"+i.toUpperCase().replace("_"," ")+":</b> "+j+"<br />"});var g=new google.maps.LatLng(h,d);var c=new google.maps.Marker({map:IPMapper.map,draggable:false,position:g});IPMapper.placeIPMarker(c,g,f)}else{IPMapper.logError("IP Address geocoding failed!");$.error("IP Address geocoding failed!")}})}else{IPMapper.logError("Invalid IP Address!");$.error("Invalid IP Address!")}},placeIPMarker:function(a,c,b){a.setPosition(c);google.maps.event.addListener(a,"click",function(){IPMapper.getIPInfoWindowEvent(a,b)});IPMapper.latlngbound.extend(c);IPMapper.map.setCenter(IPMapper.latlngbound.getCenter());IPMapper.map.fitBounds(IPMapper.latlngbound)},getIPInfoWindowEvent:function(a,b){IPMapper.infowindow.close();IPMapper.infowindow.setContent(b);IPMapper.infowindow.open(IPMapper.map,a)},uniqueArray:function(d){var b=[];for(var e=0;e<d.length;e++){for(var c=e+1;c<d.length;c++){if(d[e]===d[c]){c=++e}}b.push(d[e])}return b},logError:function(a){if(typeof console=="object"){console.error(a)}}};